# рџЋ¬ Р”РµРїР»РѕР№ РїР°РЅРµР»Рё "Р¤СѓС‚Р°Р¶Рё" (Pexels Video)

## РЁР°Рі 1: Р”РѕР±Р°РІРёС‚СЊ API РєР»СЋС‡ Pexels РІ Cloudflare Worker

Р’ С‚РµСЂРјРёРЅР°Р»Рµ (РІ РїР°РїРєРµ РїСЂРѕРµРєС‚Р°):

```bash
npx wrangler secret put PEXELS_API_KEY
```

РљРѕРіРґР° РїРѕСЏРІРёС‚СЃСЏ Р·Р°РїСЂРѕСЃ, РІСЃС‚Р°РІСЊС‚Рµ РєР»СЋС‡:
```
NHZMqv9C1XXmpx4DFSurOz7w05evFajzwJH1z5juxDfmwzEcyOnznrfV
```

**Р’Р°Р¶РЅРѕ:** РќР°Р·РІР°РЅРёРµ РїРµСЂРµРјРµРЅРЅРѕР№ РґРѕР»Р¶РЅРѕ Р±С‹С‚СЊ **РРњР•РќРќРћ** `PEXELS_API_KEY` (РєР°Рє РІ РєРѕРґРµ).

## РЁР°Рі 2: РџСЂРѕРІРµСЂРёС‚СЊ, С‡С‚Рѕ secret СѓСЃС‚Р°РЅРѕРІР»РµРЅ

```bash
npx wrangler secret list
```

Р’ СЃРїРёСЃРєРµ РґРѕР»Р¶РµРЅ Р±С‹С‚СЊ:
```
вњ” PEXELS_API_KEY
```

## РЁР°Рі 3: Р-Р°РґРµРїР»РѕРёС‚СЊ Worker

```bash
npx wrangler deploy
```

## РЁР°Рі 4: РџСЂРѕРІРµСЂРёС‚СЊ СЂР°Р±РѕС‚Сѓ Worker

### Р’Р°СЂРёР°РЅС‚ 1: Р’ Р±СЂР°СѓР·РµСЂРµ
РћС‚РєСЂРѕР№С‚Рµ РІ Р±СЂР°СѓР·РµСЂРµ:
```
https://stickers-manifest.natopchane.workers.dev/api/footage/search?query=test
```

**РћР¶РёРґР°РµРјС‹Р№ СЂРµР·СѓР»СЊС‚Р°С‚:**
- Р•СЃР»Рё РІРёРґРёС‚Рµ JSON СЃ РјР°СЃСЃРёРІРѕРј `videos` в†’ РІСЃС‘ СЂР°Р±РѕС‚Р°РµС‚ вњ…
- Р•СЃР»Рё РІРёРґРёС‚Рµ `{"error":"PEXELS_API_KEY missing"}` в†’ РєР»СЋС‡ РЅРµ СѓСЃС‚Р°РЅРѕРІР»РµРЅ вќЊ
- Р•СЃР»Рё РІРёРґРёС‚Рµ `{"error":"PEXELS_API_KEY missing"}` в†’ РІС‹РїРѕР»РЅРёС‚Рµ `npx wrangler secret put PEXELS_API_KEY`
- Р•СЃР»Рё РѕС€РёР±РєР° 404 РёР»Рё "Failed to fetch" в†’ worker РЅРµ Р·Р°РґРµРїР»РѕРµРЅ вќЊ

### Р’Р°СЂРёР°РЅС‚ 2: Р§РµСЂРµР· СЃРєСЂРёРїС‚
```bash
node check-worker.js
```

РЎРєСЂРёРїС‚ РїРѕРєР°Р¶РµС‚ РґРµС‚Р°Р»СЊРЅСѓСЋ РёРЅС„РѕСЂРјР°С†РёСЋ Рѕ СЃРѕСЃС‚РѕСЏРЅРёРё worker.

## РЁР°Рі 5: РџСЂРѕРІРµСЂРёС‚СЊ Р»РѕРіРё Worker

Р’ Cloudflare Dashboard:
1. Workers & Pages в†’ `stickers-manifest`
2. Logs в†’ View logs
3. РџСЂРѕРІРµСЂСЊС‚Рµ СЃРѕРѕР±С‰РµРЅРёСЏ:
   - `рџ”‘ PEXELS_API_KEY check:` - РґРѕР»Р¶РµРЅ РїРѕРєР°Р·С‹РІР°С‚СЊ `exists: true`
   - `рџЋ¬ Requesting Pexels:` - РґРѕР»Р¶РµРЅ РїРѕРєР°Р·С‹РІР°С‚СЊ Р·Р°РїСЂРѕСЃ
   - `рџЋ¬ Pexels response status:` - РґРѕР»Р¶РµРЅ Р±С‹С‚СЊ `200`

## Р”РёР°РіРЅРѕСЃС‚РёРєР° РїСЂРѕР±Р»РµРј

### РћС€РёР±РєР°: "PEXELS_API_KEY missing"
**Р РµС€РµРЅРёРµ:**
1. РџСЂРѕРІРµСЂСЊС‚Рµ: `npx wrangler secret list`
2. Р•СЃР»Рё РєР»СЋС‡Р° РЅРµС‚: `npx wrangler secret put PEXELS_API_KEY`
3. РџРµСЂРµР·Р°РґРµРїР»РѕР№С‚Рµ: `npx wrangler deploy`

### РћС€РёР±РєР°: "Failed to fetch" РІ Р±СЂР°СѓР·РµСЂРµ
**Р’РѕР·РјРѕР¶РЅС‹Рµ РїСЂРёС‡РёРЅС‹:**
1. Worker РЅРµ Р·Р°РґРµРїР»РѕРµРЅ в†’ РІС‹РїРѕР»РЅРёС‚Рµ `npx wrangler deploy`
2. РќРµРІРµСЂРЅС‹Р№ URL в†’ РїСЂРѕРІРµСЂСЊС‚Рµ `FOOTAGE_API_URL` РІ `FootagePanel.jsx`
3. CORS РїСЂРѕР±Р»РµРјР° в†’ РїСЂРѕРІРµСЂСЊС‚Рµ Р·Р°РіРѕР»РѕРІРєРё РІ worker
4. Worker РѕС‚РІРµС‡Р°РµС‚ 500 в†’ РїСЂРѕРІРµСЂСЊС‚Рµ Р»РѕРіРё РІ Cloudflare Dashboard

### РћС€РёР±РєР°: HTTP 401 РѕС‚ Pexels
**Р РµС€РµРЅРёРµ:**
- РџСЂРѕРІРµСЂСЊС‚Рµ, С‡С‚Рѕ РєР»СЋС‡ РїСЂР°РІРёР»СЊРЅС‹Р№
- РЈР±РµРґРёС‚РµСЃСЊ, С‡С‚Рѕ РєР»СЋС‡ Р°РєС‚РёРІРµРЅ РЅР° https://www.pexels.com/api/

### РћС€РёР±РєР°: HTTP 429 РѕС‚ Pexels
**Р РµС€РµРЅРёРµ:**
- РџСЂРµРІС‹С€РµРЅ Р»РёРјРёС‚ Р·Р°РїСЂРѕСЃРѕРІ
- РџРѕРґРѕР¶РґРёС‚Рµ РЅРµСЃРєРѕР»СЊРєРѕ РјРёРЅСѓС‚ Рё РїРѕРїСЂРѕР±СѓР№С‚Рµ СЃРЅРѕРІР°

## РЎС‚СЂСѓРєС‚СѓСЂР° РѕС‚РІРµС‚Р° Worker

Worker РІРѕР·РІСЂР°С‰Р°РµС‚ JSON РІ С„РѕСЂРјР°С‚Рµ:
```json
{
  "videos": [
    {
      "id": 123456,
      "previewUrl": "https://...",
      "videoUrlHd": "https://...",
      "videoUrlFull": "https://...",
      "duration": 30,
      "width": 1920,
      "height": 1080
    }
  ],
  "page": 1,
  "perPage": 24,
  "totalResults": 1000,
  "nextPage": 2
}
```

## РўРµСЃС‚РёСЂРѕРІР°РЅРёРµ Р»РѕРєР°Р»СЊРЅРѕ

Р”Р»СЏ Р»РѕРєР°Р»СЊРЅРѕРіРѕ С‚РµСЃС‚РёСЂРѕРІР°РЅРёСЏ (РµСЃР»Рё РЅСѓР¶РЅРѕ):

```bash
npx wrangler dev
```

Worker Р±СѓРґРµС‚ РґРѕСЃС‚СѓРїРµРЅ РЅР° `http://localhost:8787`

Р’ `FootagePanel.jsx` РІСЂРµРјРµРЅРЅРѕ РёР·РјРµРЅРёС‚Рµ:
```javascript
const FOOTAGE_API_URL = 'http://localhost:8787/api/footage/search'
```

**РќРµ Р·Р°Р±СѓРґСЊС‚Рµ РІРµСЂРЅСѓС‚СЊ РѕР±СЂР°С‚РЅРѕ РїРѕСЃР»Рµ С‚РµСЃС‚РёСЂРѕРІР°РЅРёСЏ!**

